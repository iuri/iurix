***************
*** 9,14 ****
      @cvs-id $Id: photo-album-ajaxpa.diff,v 1.1 2009/04/11 15:56:13 hamiltonc Exp $
  } {
      album_id:integer,notnull
  } -validate {
      valid_album -requires {album_id:integer} {
  	if [string equal [pa_is_album_p $album_id] "f"] {
--- 9,15 ----
      @cvs-id $Id: photo-album-ajaxpa.diff,v 1.1 2009/04/11 15:56:13 hamiltonc Exp $
  } {
      album_id:integer,notnull
+     return_url:optional
  } -validate {
      valid_album -requires {album_id:integer} {
  	if [string equal [pa_is_album_p $album_id] "f"] {
***************
*** 90,96 ****
  	
  	ad_script_abort
      }
-     ad_returnredirect "album?album_id=$album_id"
      ad_script_abort
  }
  
--- 91,103 ----
  	
  	ad_script_abort
      }
+     
+     # HAM : added return_url
+     if { ![exists_and_not_null return_url] } {
+         ad_returnredirect "album?album_id=$album_id"
+     } else {
+         ad_returnredirect $return_url
+     }
      ad_script_abort
  }
  
