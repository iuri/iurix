***************
*** 11,16 ****
  } {
      folder_id:integer,notnull
      {confirmed_p "f"}
  } -validate {
      valid_folder -requires {folder_id:integer} {
  	if [string equal [pa_is_folder_p $folder_id] "f"] {
--- 11,17 ----
  } {
      folder_id:integer,notnull
      {confirmed_p "f"}
+     return_url:optional
  } -validate {
      valid_folder -requires {folder_id:integer} {
  	if [string equal [pa_is_folder_p $folder_id] "f"] {
***************
*** 50,56 ****
          content_folder.del(:folder_id);
      end;"
  
-     ad_returnredirect "?folder_id=$parent_folder_id"
      ad_script_abort
  } else {
      # they still need to confirm
--- 51,64 ----
          content_folder.del(:folder_id);
      end;"
  
+     # HAM : added return_url
+     if { ![exists_and_not_null return_url] } {
+         #redirect back to index page with parent_id
+         ad_returnredirect "?folder_id=$parent_folder_id"
+     } else {
+         ad_returnredirect $return_url
+     }
+ 
      ad_script_abort
  } else {
      # they still need to confirm
