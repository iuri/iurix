***************
*** 11,16 ****
      {hide:integer 0}
      {photo_id:integer 0}
      d:array,integer,optional
  } -properties {
      path:onevalue
      height:onevalue
--- 11,17 ----
      {hide:integer 0}
      {photo_id:integer 0}
      d:array,integer,optional
+     return_url:optional
  } -properties {
      path:onevalue
      height:onevalue
***************
*** 122,128 ****
  	ad_script_abort
      }
      
-     ad_returnredirect "photo?photo_id=$photo_id"
      ad_script_abort
  }
  
--- 123,135 ----
  	ad_script_abort
      }
      
+     # HAM : added return_url
+     if { ![exists_and_not_null return_url] } {
+         ad_returnredirect "photo?photo_id=$photo_id"
+     } else {
+         ad_returnredirect $return_url
+     }
+ 
      ad_script_abort
  }
  
